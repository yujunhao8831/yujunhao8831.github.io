<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="个人日志记录"><title>spring-小技巧-2 | 披荆斩棘</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">spring-小技巧-2</h1><a id="logo" href="/.">披荆斩棘</a><p class="description">时间就是金钱,我的朋友.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="https://github.com/yujunhao8831/"><i class="fa undefined"> GitHub</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">spring-小技巧-2</h1><div class="post-meta">Jul 9, 2017<span> | </span><span class="category"><a href="/categories/编程/">编程</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#spring-boot-Remote-debug-tunnel"><span class="toc-number">1.</span> <span class="toc-text">spring boot Remote debug tunnel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#运行时得到端口"><span class="toc-number">2.</span> <span class="toc-text">运行时得到端口</span></a></li></ol></div></div><div class="post-content"><p>##<br>使用<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// @ConditionalOnBean 在当前上下文中存在某个对象时,才会实例化一个Bean</span></span><br><span class="line"><span class="comment">// @ConditionalOnClass // 某个class位于类路径上,才会实例化一个Bean</span></span><br><span class="line"><span class="comment">// @ConditionalOnCloudPlatform</span></span><br><span class="line"><span class="comment">// @ConditionalOnExpression</span></span><br><span class="line"><span class="comment">// @ConditionalOnJava</span></span><br><span class="line"><span class="comment">// @ConditionalOnJndi</span></span><br><span class="line"><span class="comment">// @ConditionalOnMissingBean 在当前上下文中不存在某个对象时,才会实例化一个Bean</span></span><br><span class="line"><span class="comment">// @ConditionalOnMissingClass 某个class类路径上不存在的时候,才会实例化一个Bea</span></span><br><span class="line"><span class="comment">// @ConditionalOnNotWebApplication</span></span><br><span class="line"><span class="comment">// @ConditionalOnProperty</span></span><br><span class="line"><span class="comment">// @ConditionalOnResource</span></span><br><span class="line"><span class="comment">// @ConditionalOnSingleCandidate</span></span><br><span class="line"><span class="comment">// @ConditionalOnWebApplication</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="comment">// 设置默认false,这样默认不会实例化这个bean,当表达式为true的时候,才会实例化一个Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnExpression</span>( <span class="string">"$&#123;aidijing.filter.injection-attack-filter.enabled:false&#125;"</span> )</span><br><span class="line"><span class="function"><span class="keyword">public</span> InjectionAttackFilter <span class="title">injectionAttackFilter</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> InjectionAttackFilter();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="spring-boot-Remote-debug-tunnel"><a href="#spring-boot-Remote-debug-tunnel" class="headerlink" title="spring boot Remote debug tunnel"></a>spring boot Remote debug tunnel</h2><p><a href="http://docs.spring.io/spring-boot/docs/1.5.6.RELEASE/reference/htmlsingle/" target="_blank" rel="noopener">http://docs.spring.io/spring-boot/docs/1.5.6.RELEASE/reference/htmlsingle/</a></p>
<p>20.5.3 Remote debug tunnel</p>
<p>Java remote debugging is useful when diagnosing issues on a remote application. Unfortunately, it’s not always possible to enable remote debugging when your application is deployed outside of your data center. Remote debugging can also be tricky to setup if you are using a container based technology such as Docker.</p>
<p>To help work around these limitations, devtools supports tunneling of remote debug traffic over HTTP. The remote client provides a local server on port 8000 that you can attach a remote debugger to. Once a connection is established, debug traffic is sent over HTTP to the remote application. You can use the spring.devtools.remote.debug.local-port property if you want to use a different port.</p>
<p>You’ll need to ensure that your remote application is started with remote debugging enabled. Often this can be achieved by configuring JAVA_OPTS. For example, with Cloud Foundry you can add the following to your manifest.yml:</p>
<hr>
<pre><code>env:
    JAVA_OPTS: &quot;-Xdebug -Xrunjdwp:server=y,transport=dt_socket,suspend=n&quot;
</code></pre><p>[Tip]<br>Notice that you don’t need to pass an address=NNNN option to -Xrunjdwp. If omitted Java will simply pick a random free port.<br>[Note]<br>Debugging a remote service over the Internet can be slow and you might need to increase timeouts in your IDE. For example, in Eclipse you can select Java → Debug from Preferences…​ and change the Debugger timeout (ms) to a more suitable value (60000 works well in most situations).<br>[Warning]<br>When using the remote debug tunnel with IntelliJ IDEA, all breakpoints must be configured to suspend the thread rather than the VM. By default, breakpoints in IntelliJ IDEA suspend the entire VM rather than only suspending the thread that hit the breakpoint. This has the unwanted side-effect of suspending the thread that manages the remote debug tunnel, causing your debugging session to freeze. When using the remote debug tunnel with IntelliJ IDEA, all breakpoints should be configured to suspend the thread rather than the VM. Please see IDEA-165769 for further details.</p>
<h2 id="运行时得到端口"><a href="#运行时得到端口" class="headerlink" title="运行时得到端口"></a>运行时得到端口</h2><p>73.4 Discover the HTTP port at runtime<br>You can access the port the server is running on from log output or from the EmbeddedWebApplicationContext via its EmbeddedServletContainer. The best way to get that and be sure that it has initialized is to add a @Bean of type ApplicationListener<embeddedservletcontainerinitializedevent> and pull the container out of the event when it is published.</embeddedservletcontainerinitializedevent></p>
<p>Tests that use @SpringBootTest(webEnvironment=WebEnvironment.RANDOM_PORT) can also inject the actual port into a field using the @LocalServerPort annotation. For example:</p>
<p>@RunWith(SpringJUnit4ClassRunner.class)<br>@SpringBootTest(webEnvironment=WebEnvironment.RANDOM_PORT)<br>public class MyWebIntegrationTests {</p>
<pre><code>@Autowired
EmbeddedWebApplicationContext server;

@LocalServerPort
int port;

// ...
</code></pre><p>}</p>
</div><iframe src="/donate/?AliPayQR=null&amp;WeChatQR=/images/pijingzhanji.JPG&amp;GitHub=null&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://yujunhao8831.github.io/2017/07/09/spring-小技巧-2/" data-id="clhdido1n003q1wf8asakdqa2" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACIklEQVR42u3a3WrDMAwG0L3/S2e3g+LwSUoHsY+vyto0Pilo1s/PT7yuxfr77ucnP99dffPq2ocXBgbGaxnX7bq/QX7jK1j3sNXnMTAwzmEkofA+pK6QCa8arDEwMDCqjGpwzP+OgYGB0WPkyPuDYxK4MTAwMKpJbK8ClmzoX3NxDAyMFzImG/r266/0NzAwMF7FuIqrVzibHBCjXWFgYGzNqJbvkwZA/noScDEwMM5h5KX5yVhY/lCarVAMDIytGfOjXrLd/MH12g8YGBgY1UJ8NWXthVoMDIzTGNURh3nRPz+AFh4uBgbGpozkWFa9Zf6dk4GMci0QAwPjtYzeBdWtJKlpr9AW/T4YGBgvZ0y222s2TFLiZbkNAwNja8akMZBstDpg8cVjIgYGxmsZ+fBEjpwkusm9ylEZAwNjI0b14mq5v9c8iB4cBgbGkYxq+WwSA/PBi+UeMDAwtmbkbydpajWM9gpzUdkOAwNjO0a1TNYbyKgmz3kTFAMD4xzGU02C/JjYG7lYsjEwMA5gPNuGrLYZ5gU4DAyMExjJBb3WZtLmrI6IFf4nYGBgvJxxFVf12jwFnYxiYGBg7M3IV+9QWG0qzAcyMDAwdmVMgmbvYJeksuXnjYGBcQDjG+lodXRjslsMDAyM6gjXPGRXHw0GBgbGvHxWDqDVsQwMDIwDGL0A2hvIqAbuh8ttGBgYL2RUU8deizEB9NoDGBgYWzN+Ac6r2xnSoJ4lAAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/spring-spring-小技巧/">spring spring-小技巧</a></div><div class="post-nav"><a class="pre" href="/2017/07/09/spring-scheduling-实现分布式调度/">spring-scheduling-实现分布式调度</a><a class="next" href="/2017/07/09/spring-小技巧/">spring-小技巧</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: '18e1ad18c984fd09f33e',
  clientSecret: '957f160a646fce08b0c0f13eb15a1a636ae70ac3',
  repo: 'yujunhao8831.github.io',
  owner: 'yujunhao8831',
  admin: ['yujunhao8831'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://yujunhao8831.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/交易/">交易</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活/">生活</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程/">编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/金融/">金融</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/脚手架/" style="font-size: 15px;">脚手架</a> <a href="/tags/股票/" style="font-size: 15px;">股票</a> <a href="/tags/2019/" style="font-size: 15px;">2019</a> <a href="/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/规则引擎/" style="font-size: 15px;">规则引擎</a> <a href="/tags/Spring-Cloud/" style="font-size: 15px;">Spring-Cloud</a> <a href="/tags/Hystrix/" style="font-size: 15px;">Hystrix</a> <a href="/tags/Feign/" style="font-size: 15px;">Feign</a> <a href="/tags/Ribbon/" style="font-size: 15px;">Ribbon</a> <a href="/tags/Zuul/" style="font-size: 15px;">Zuul</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/Restful-API/" style="font-size: 15px;">Restful API</a> <a href="/tags/Swagger/" style="font-size: 15px;">Swagger</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/mql5/" style="font-size: 15px;">mql5</a> <a href="/tags/MyBatis/" style="font-size: 15px;">MyBatis</a> <a href="/tags/spring-spring-boot-admin/" style="font-size: 15px;">spring spring-boot-admin</a> <a href="/tags/缠中说禅/" style="font-size: 15px;">缠中说禅</a> <a href="/tags/Eureka/" style="font-size: 15px;">Eureka</a> <a href="/tags/spring-spring-boot-spring-cache-redis/" style="font-size: 15px;">spring spring-boot spring-cache-redis</a> <a href="/tags/分布式调度/" style="font-size: 15px;">分布式调度</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/spring-spring-小技巧/" style="font-size: 15px;">spring spring-小技巧</a> <a href="/tags/分布式session共享/" style="font-size: 15px;">分布式session共享</a> <a href="/tags/vpn/" style="font-size: 15px;">vpn</a> <a href="/tags/java-web/" style="font-size: 15px;">java web</a> <a href="/tags/观后感/" style="font-size: 15px;">观后感</a> <a href="/tags/测试/" style="font-size: 15px;">测试</a> <a href="/tags/多线程日志用户跟踪/" style="font-size: 15px;">多线程日志用户跟踪</a> <a href="/tags/问题/" style="font-size: 15px;">问题</a> <a href="/tags/目标/" style="font-size: 15px;">目标</a> <a href="/tags/交易/" style="font-size: 15px;">交易</a> <a href="/tags/理念/" style="font-size: 15px;">理念</a> <a href="/tags/疑惑/" style="font-size: 15px;">疑惑</a> <a href="/tags/Log4j2-日志/" style="font-size: 15px;">Log4j2 日志</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/10/09/2020-10-09-指数见解/">2020-10-09-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/05/2020-05-05-指数见解/">2020-05-05-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/06/2020-03-06-指数见解/">2020-03-06-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/29/2019-07-29-指数见解/">2019-07-29-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/13/2019-05-13-指数见解/">2019-05-13-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/28/2019-角落博文有感/">2019-角落博文有感</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/25/2019-缠中说禅-教你炒股票11-理解/">2019-缠中说禅-教你炒股票11-理解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/24/2019-03-24-指数见解/">2019-03-24-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/12/2019-缠中说禅-教你炒股票10-理解/">2019-缠中说禅-教你炒股票10-理解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/12/2019-缠中说禅-教你炒股票9-理解/">2019-缠中说禅-教你炒股票9-理解</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">披荆斩棘.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" color="204, 255, 222" opacity="0.5" zIndex="-1" count="666" src="//lib.baomitu.com/canvas-nest.js/2.0.3/canvas-nest.umd.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script><script type="text/javascript" src="js/baidutongji.js?v=0.0.0"></script></div></body></html>