<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="个人日志记录"><title>spring-小技巧 | 披荆斩棘</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">spring-小技巧</h1><a id="logo" href="/.">披荆斩棘</a><p class="description">时间就是金钱,我的朋友.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="https://github.com/yujunhao8831/"><i class="fa undefined"> GitHub</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">spring-小技巧</h1><div class="post-meta">Jul 9, 2017<span> | </span><span class="category"><a href="/categories/编程/">编程</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#需要得到Spring相关信息"><span class="toc-number">1.</span> <span class="toc-text">需要得到Spring相关信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Aware接口"><span class="toc-number">1.1.</span> <span class="toc-text">Aware接口</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#初始化信息"><span class="toc-number">2.</span> <span class="toc-text">初始化信息?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#初始化还不满足需求-我想在Spring上下文全部加载完后做点什么"><span class="toc-number">3.</span> <span class="toc-text">初始化还不满足需求?我想在Spring上下文全部加载完后做点什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#请求处理"><span class="toc-number">4.</span> <span class="toc-text">请求处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#异常处理"><span class="toc-number">5.</span> <span class="toc-text">异常处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#流程控制"><span class="toc-number">6.</span> <span class="toc-text">流程控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#json-字段动态过滤"><span class="toc-number">7.</span> <span class="toc-text">json 字段动态过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#我想得到当前请求的原始uri并得到path变量的相关值-以及解析过程"><span class="toc-number">8.</span> <span class="toc-text">我想得到当前请求的原始uri并得到path变量的相关值,以及解析过程</span></a></li></ol></div></div><div class="post-content"><h2 id="需要得到Spring相关信息"><a href="#需要得到Spring相关信息" class="headerlink" title="需要得到Spring相关信息"></a>需要得到Spring相关信息</h2><h3 id="Aware接口"><a href="#Aware接口" class="headerlink" title="Aware接口"></a>Aware接口</h3><p>XXXAware在Spring中表示对XXX可以感知,通俗的说就是 : 如果某个类中想要使用Spring的一些东西,<br>只要实现XXXAware接口即可.</p>
<p>比如 : userController中想使用ApplicationContext,那么只需要实现ApplicationContextAware接口即可.</p>
<ul>
<li>EnvironmentAware<br>该接口具有Environment(环境)的能力,封装了ServletContext,ServletConfig,JndiProperty,系统环境变量和系统属性.这些都封装到了propertySources属性下.</li>
</ul>
<p>ServletConfigPropertySource :  : 存放ServletConfig<br>ServletContextPropertySource : 存放ServletContext<br>JndiPropertySource : 存的是Jndi<br>MapPropertySource  : 所有虚拟机的属性<br>SystemEnvironmentPropertySource : 系统变量<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> StandardServletEnvironment standardServletEnvironment = ( StandardServletEnvironment ) environment;</span><br><span class="line"><span class="keyword">final</span> MutablePropertySources     propertySources            = standardServletEnvironment.getPropertySources();</span><br><span class="line"><span class="keyword">final</span> PropertySource&lt; ? &gt;        systemProperties           = propertySources.get( <span class="string">"systemProperties"</span> );</span><br><span class="line"><span class="keyword">final</span> Object                     source                     = systemProperties.getSource();</span><br><span class="line"><span class="keyword">final</span> Properties                 properties                 = ( Properties ) source;</span><br><span class="line">System.err.println( <span class="string">"java.vendor    =    "</span> + properties.getProperty( <span class="string">"java.vendor"</span> ) ); <span class="comment">// 这样就可以得到环境的所有信息了</span></span><br><span class="line">System.err.println( <span class="string">"XXX    =    "</span> + properties.getProperty( <span class="string">"XXXX"</span> ) );</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/java/spring-aware-01.png" data-action="zoom"></p>
<ul>
<li><p>BeanFactoryAware<br>首先继承这个接口是为了得到BeanFactory的引用，进而得到想要的Bean。但是这样做是违反DI注入原则的，所以Spring是不建议这样做的。所以你会发现，想继承这个接口必须在applicationContext.xml里实例Bean。而且我怀疑，这个BeanFactroyAware只是一个标识接口(自己理解的叫法)，和BeanNameAware接口一样，只是在实例化的时候，判断是否继承这些接口了，进而通过反射固定的方法，然后给对应的调用方法。</p>
</li>
<li><p>ApplicationContextAware<br>Spring将调用setApplicationContext (),将bean所在的上下文的引用传入进来</p>
</li>
</ul>
<ul>
<li>xxxAware<br>… …<br>更多可看源码,想要什么在源码中看注释选择即可.<br><img src="/images/java/spring-aware-02.png" data-action="zoom"></li>
</ul>
<h2 id="初始化信息"><a href="#初始化信息" class="headerlink" title="初始化信息?"></a>初始化信息?</h2><ul>
<li><p>BeanPostProcessor<br><img src="/images/java/spring-init-01.png" data-action="zoom"></p>
</li>
<li><p>InitializingBean</p>
</li>
</ul>
<p>实现该接口的方法,初始化时会被调用</p>
<ul>
<li>BeanPostProcessor</li>
</ul>
<p>同上</p>
<ul>
<li>DisposableBean</li>
</ul>
<p>与上面相反,上下文被销毁后会调用实现该接口的方法.</p>
<p>当然还有注解形式的</p>
<ul>
<li>@PostConstruct @PreDestroy</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化</span></span><br><span class="line"><span class="meta">@PostConstruct</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    System.err.println(<span class="string">"init"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 销毁</span></span><br><span class="line"><span class="meta">@PreDestroy</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    System.err.println(<span class="string">"destroy"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/java/spring-init-00.png" data-action="zoom"></p>
<h2 id="初始化还不满足需求-我想在Spring上下文全部加载完后做点什么"><a href="#初始化还不满足需求-我想在Spring上下文全部加载完后做点什么" class="headerlink" title="初始化还不满足需求?我想在Spring上下文全部加载完后做点什么"></a>初始化还不满足需求?我想在Spring上下文全部加载完后做点什么</h2><p>虽然对Spring很了解,但是Spring组件加载顺序不可能都能记清楚,我就想等Spring组件全部加载完后,然后获取Spring相关组件,如果在初始化中获取,不清楚加载顺序,可能不一定能获取到</p>
<ul>
<li>ApplicationListener<e extends="" applicationevent=""></e></li>
</ul>
<p>初始化之后事件</p>
<p><img src="/images/java/spring-init-03.png" data-action="zoom"></p>
<ul>
<li>我想获取应用的所有RequestMapping信息,我尝试过在init中获取,因为加载顺序问题,获取为空,那么我在Spring全部加载完后获取即可</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> : 披荆斩棘</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> : 2017/6/22</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConditionalOnExpression</span>( <span class="string">"$&#123;aidijing.basic-bean.enabled:false&#125;"</span> )</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BasicBeanConfig</span> <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span>, <span class="title">ApplicationListener</span>&lt; <span class="title">ContextRefreshedEvent</span> &gt; </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext applicationContext;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所有 &#123;<span class="doctag">@link</span> org.springframework.web.bind.annotation.RequestMapping#value()&#125; 值 &lt;br/&gt;</span></span><br><span class="line"><span class="comment">     * 比如 : [[/authentication], [/authentication], [/api/user/&#123;id&#125;], [/api/user/&#123;id&#125;]]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt; Set&lt; String &gt; &gt; requestMappingUris = <span class="keyword">new</span> CopyOnWriteArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> org.springframework.web.bind.annotation.RequestMapping&#125; 原始信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt; RequestMappingInfo, HandlerMethod &gt; handlerMethods;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * [&#123;[/authentication]=[POST]&#125;, &#123;[/authentication]=[PUT]&#125;, &#123;[/captcha/login]=[GET]&#125;, &#123;[/captcha]=[GET]&#125;, &#123;[/api/user/&#123;id&#125;]=[GET]&#125;, &#123;[/api/user/&#123;id&#125;]=[PUT]&#125;, &#123;[/api/user/&#123;id&#125;]=[DELETE]&#125;, &#123;[/api/user]=[POST]&#125;, &#123;[/api/user/test]=[GET]&#125;, &#123;[/api/user]=[GET]&#125;, &#123;[/api/user/distributed-lock]=[GET]&#125;, &#123;[/api/user/async]=[GET]&#125;, &#123;[/api/user/list]=[GET]&#125;, &#123;[/v2/api-docs]=[GET]&#125;, &#123;[/swagger-resources/configuration/security]=[]&#125;, &#123;[/swagger-resources/configuration/ui]=[]&#125;, &#123;[/swagger-resources]=[]&#125;, &#123;[/error]=[]&#125;, &#123;[/error]=[]&#125;]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt; Map&lt; Set&lt; String &gt;, Set&lt; RequestMethod &gt; &gt; &gt; requestMappingInfos               = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">/** 所有请求方法 **/</span></span><br><span class="line">    <span class="keyword">private</span> Set&lt; RequestMethod &gt;                               requestMethodsRequestConditionAll = <span class="keyword">new</span> LinkedHashSet&lt;&gt;(</span><br><span class="line">            Arrays.asList(</span><br><span class="line">                    RequestMethod.GET,</span><br><span class="line">                    RequestMethod.HEAD,</span><br><span class="line">                    RequestMethod.POST,</span><br><span class="line">                    RequestMethod.PUT,</span><br><span class="line">                    RequestMethod.PATCH,</span><br><span class="line">                    RequestMethod.DELETE,</span><br><span class="line">                    RequestMethod.OPTIONS,</span><br><span class="line">                    RequestMethod.TRACE</span><br><span class="line">            )</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> List&lt; Set&lt; String &gt; &gt; requestMappingUris () &#123;</span><br><span class="line">        <span class="keyword">return</span> requestMappingUris;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt; RequestMappingInfo, HandlerMethod &gt; handlerMethods () &#123;</span><br><span class="line">        <span class="keyword">return</span> handlerMethods;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> List&lt; Map&lt; Set&lt; String &gt;, Set&lt; RequestMethod &gt; &gt; &gt; requestMappingInfos () &#123;</span><br><span class="line">        <span class="keyword">return</span> requestMappingInfos;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span> <span class="params">( ApplicationContext applicationContext )</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.applicationContext = applicationContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Spring上下文加载完后,会执行该方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onApplicationEvent</span> <span class="params">( ContextRefreshedEvent event )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> RequestMappingHandlerMapping requestMappingHandlerMapping =</span><br><span class="line">                applicationContext.getBean( RequestMappingHandlerMapping.class );</span><br><span class="line">        <span class="keyword">final</span> Map&lt; RequestMappingInfo, HandlerMethod &gt; handlerMethods =</span><br><span class="line">                requestMappingHandlerMapping.getHandlerMethods();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.handlerMethods = handlerMethods;</span><br><span class="line"></span><br><span class="line">        handlerMethods.keySet().forEach( mappingInfo -&gt; &#123;</span><br><span class="line">            Map&lt; Set&lt; String &gt;, Set&lt; RequestMethod &gt; &gt; mapping = <span class="keyword">new</span> HashMap();</span><br><span class="line">            mapping.put(</span><br><span class="line">                    mappingInfo.getPatternsCondition().getPatterns(),</span><br><span class="line">                    <span class="keyword">this</span>.getMethods( mappingInfo.getMethodsCondition().getMethods() )</span><br><span class="line">            );</span><br><span class="line">            requestMappingInfos.add( mapping );</span><br><span class="line">        &#125; );</span><br><span class="line"></span><br><span class="line">        requestMappingUris.addAll(</span><br><span class="line">                handlerMethods.keySet()</span><br><span class="line">                              .parallelStream()</span><br><span class="line">                              .map( mappingInfo -&gt; mappingInfo.getPatternsCondition().getPatterns() )</span><br><span class="line">                              .collect( Collectors.toList() )</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 因为如果支持所有方式请求的话默认是[],但是为了显示效果这里进行补全</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> methods</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> RequestMethod</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Set&lt; RequestMethod &gt; getMethods ( Set&lt; RequestMethod &gt; methods ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( ! CollectionUtils.isEmpty( methods ) ) &#123;</span><br><span class="line">            <span class="keyword">return</span> methods;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> requestMethodsRequestConditionAll;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样我就得到了所有RequestMapping信息</p>
<h2 id="请求处理"><a href="#请求处理" class="headerlink" title="请求处理"></a>请求处理</h2><p>我想在接收请求和响应请求时,对某些参数做些处理</p>
<ul>
<li>WebMvcConfigurerAdapter</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解析请求参数</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addArgumentResolvers</span> <span class="params">( List&lt; HandlerMethodArgumentResolver &gt; argumentResolvers )</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 如果 Controller 方法中的参数有 PageRowBounds 则从前台获取数据组装, 如果没有传递则给设置一个默认值</span></span><br><span class="line">        argumentResolvers.add( <span class="keyword">new</span> HandlerMethodArgumentResolver() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsParameter</span> <span class="params">( MethodParameter parameter )</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> PageRowBounds.class.isAssignableFrom( parameter.getParameterType() );</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">resolveArgument</span> <span class="params">( MethodParameter parameter, ModelAndViewContainer mavContainer,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            NativeWebRequest request, WebDataBinderFactory factory )</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                <span class="keyword">int</span> pageNum = NumberUtils.toInt( request.getParameter( GlobalConstant.PAGE_NUM_PARAM_NAME ) );</span><br><span class="line">                <span class="keyword">if</span> ( pageNum &lt;= <span class="number">0</span> ) &#123;</span><br><span class="line">                    pageNum = GlobalConstant.DEFAULT_PAGE_NUM;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">int</span> pageSize = NumberUtils.toInt( request.getParameter( GlobalConstant.PAGE_SIZE_PARAM_NAME ) );</span><br><span class="line">                <span class="keyword">if</span> ( pageSize &lt;= <span class="number">0</span> ) &#123;</span><br><span class="line">                    pageSize = GlobalConstant.DEFAULT_PAGE_SIZE;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> PageRowBounds( pageNum, pageSize );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 这样在控制器中,就是前端不传值,我也有默认值</span></span><br><span class="line">GetMapping</span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt; PageInfo&lt; UserVO &gt; &gt; listPage ( PageRowBounds pageRowBounds ) &#123;</span><br><span class="line">    <span class="keyword">return</span> ResponseEntity.ok().setResponseContent( userService.listPage( pageRowBounds) );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>响应请求时如何处理配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Add handlers to support custom controller method return value types.</span></span><br><span class="line"><span class="comment">	 * &lt;p&gt;Using this option does not override the built-in support for handling</span></span><br><span class="line"><span class="comment">	 * return values. To customize the built-in support for handling return</span></span><br><span class="line"><span class="comment">	 * values, configure RequestMappingHandlerAdapter directly.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> returnValueHandlers initially an empty list</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">    <span class="comment">// 响应请求时进行处理</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addReturnValueHandlers</span> <span class="params">( List&lt; HandlerMethodReturnValueHandler &gt; returnValueHandlers )</span> </span>&#123;</span><br><span class="line">       returnValueHandlers.add( <span class="keyword">new</span> HandlerMethodReturnValueHandler() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsReturnType</span> <span class="params">( MethodParameter returnType )</span> </span>&#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleReturnValue</span> <span class="params">( Object returnValue,</span></span></span><br><span class="line"><span class="function"><span class="params">                                           MethodParameter returnType,</span></span></span><br><span class="line"><span class="function"><span class="params">                                           ModelAndViewContainer mavContainer,</span></span></span><br><span class="line"><span class="function"><span class="params">                                           NativeWebRequest webRequest )</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line">       &#125; );</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>响应请求处理方式,我喜欢用 ResponseBodyAdvice 接口处理</p>
<ul>
<li>ResponseBodyAdvice<t></t></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * api &#123;<span class="doctag">@link</span> ResponseEntity&#125; 返回类型处理,针对 &#123;<span class="doctag">@link</span> com.aidijing.domain.RolePermissionResource#resourceApiUriShowFields&#125; 字段</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> : 披荆斩棘</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> : 2017/6/29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalResponseController</span> <span class="keyword">implements</span> <span class="title">ResponseBodyAdvice</span>&lt; <span class="title">ResponseEntity</span> &gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span> <span class="params">( MethodParameter returnType, Class converterType )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.class.isAssignableFrom( returnType.getParameterType() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 响应之前对 ResponseEntity 进行后处理,因为我的系统中,所有返回请求都是使用 ResponseEntity 进行封装返回</span></span><br><span class="line">    <span class="comment">// 比如我可以对响应实体中的内容进行过滤,对某些字段进行加密,或者不显示某些字段,这样就不用再具体代码中进行编码了,减少了代码量和耦合</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">beforeBodyWrite</span> <span class="params">( ResponseEntity body,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            MethodParameter returnType,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            MediaType selectedContentType,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            Class selectedConverterType,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            ServerHttpRequest request,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            ServerHttpResponse response )</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 如果自行设置了,那么就以自行设置的为主</span></span><br><span class="line">        <span class="keyword">if</span> ( body.isFieldsFilter() ) &#123;</span><br><span class="line">            <span class="keyword">return</span> body.filterFieldsFlush();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果当前用户的这个接口权限本来就可以查看全部</span></span><br><span class="line">        <span class="keyword">if</span> ( ResponseEntity.WILDCARD_ALL.equals( ContextUtils.getCurrentRequestApiShowFields() ) ) &#123;</span><br><span class="line">            <span class="keyword">return</span> body;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> body.setFilterFieldsAndFlush( ContextUtils.getCurrentRequestApiShowFields() );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><ul>
<li>这里我只喜欢使用 @RestControllerAdvice + @ExceptionHandler 进行处理</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> : 披荆斩棘</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> : 2017/5/18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalErrorController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>( UsernameNotFoundException.class )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">serviceErrorHandler</span> <span class="params">( UsernameNotFoundException e )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( LogUtils.getLogger().isErrorEnabled() ) &#123;</span><br><span class="line">            LogUtils.getLogger().error( <span class="string">"error"</span>, e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.unauthorized();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>( AuthenticationException.class )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">serviceErrorHandler</span> <span class="params">( AuthenticationException e )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( LogUtils.getLogger().isErrorEnabled() ) &#123;</span><br><span class="line">            LogUtils.getLogger().error( <span class="string">"error"</span>, e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.unauthorized();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>( ForbiddenException.class )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">forbiddenErrorHandler</span> <span class="params">( ForbiddenException e )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( LogUtils.getLogger().isErrorEnabled() ) &#123;</span><br><span class="line">            LogUtils.getLogger().error( <span class="string">"error"</span>, e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.forbidden( e.getMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>( CaptchaException.class )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">captchaErrorHandler</span> <span class="params">( CaptchaException e )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( LogUtils.getLogger().isErrorEnabled() ) &#123;</span><br><span class="line">            LogUtils.getLogger().error( <span class="string">"error"</span>, e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.badRequest( e.getMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>( ServiceException.class )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">serviceErrorHandler</span> <span class="params">( ServiceException e )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( LogUtils.getLogger().isErrorEnabled() ) &#123;</span><br><span class="line">            LogUtils.getLogger().error( <span class="string">"error"</span>, e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.badRequest( e.getMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>( DaoException.class )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">daoErrorHandler</span> <span class="params">( DaoException e )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( LogUtils.getLogger().isErrorEnabled() ) &#123;</span><br><span class="line">            LogUtils.getLogger().error( <span class="string">"error"</span>, e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.badRequest( e.getMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>( &#123; SQLException.class , DataAccessException.class &#125; )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">sqlErrorHandler</span> <span class="params">( Throwable e )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( LogUtils.getLogger().isErrorEnabled() ) &#123;</span><br><span class="line">            LogUtils.getLogger().error( <span class="string">"error"</span>, e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.internalServerError( <span class="string">"服务器内部错误,EXCEPTION_CODE:"</span> + ExceptionCode.SQL_EXCEPTION.getCode() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>( Throwable.class )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">globalErrorHandler</span> <span class="params">( Throwable e )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( LogUtils.getLogger().isErrorEnabled() ) &#123;</span><br><span class="line">            LogUtils.getLogger().error( <span class="string">"internalServerError"</span>, e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.internalServerError( <span class="string">"internalServerError : "</span> + e.getMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">enum</span> ExceptionCode &#123;</span><br><span class="line">        SQL_EXCEPTION( <span class="string">"9001"</span>, <span class="string">"SQL异常"</span> );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String code;</span><br><span class="line">        <span class="keyword">private</span> String comment;</span><br><span class="line"></span><br><span class="line">        ExceptionCode ( String code, String comment ) &#123;</span><br><span class="line">            <span class="keyword">this</span>.code = code;</span><br><span class="line">            <span class="keyword">this</span>.comment = comment;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 判断传入的code是否是枚举中所定义的code</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> code</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isCode</span> <span class="params">( <span class="keyword">final</span> String code )</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> ( ExceptionCode value : ExceptionCode.values() ) &#123;</span><br><span class="line">                <span class="keyword">if</span> ( value.getCode().equalsIgnoreCase( code ) ) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">codeValue</span> <span class="params">( <span class="keyword">final</span> String code )</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> ( ExceptionCode value : ExceptionCode.values() ) &#123;</span><br><span class="line">                <span class="keyword">if</span> ( value.getCode().equalsIgnoreCase( code ) ) &#123;</span><br><span class="line">                    <span class="keyword">return</span> value.getComment();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isNotCode</span> <span class="params">( <span class="keyword">final</span> String code )</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> ! isCode( code );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getComment</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> comment;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getCode</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><ul>
<li>和异常处理搭配使用</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 断言</span></span><br><span class="line"><span class="comment"> * 使用异常流程控制,异常控制流程比if else '状态码'控制可读性更强</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> * &lt;b style="color:red"&gt;</span></span><br><span class="line"><span class="comment"> * 注 : 异常的处理效率比条件分支低,内部系统可用异常形式控制流程,对外http/api接口则使用'错误码'.</span></span><br><span class="line"><span class="comment"> * &lt;/b&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> : 披荆斩棘</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> : 2017/6/3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AssertUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 如果条件为&lt;code&gt;true&lt;/code&gt; throw &#123;<span class="doctag">@link</span> CaptchaException&#125;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> condition : 断言条件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message   : 错误信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> CaptchaException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">assertCaptchaIsTrue</span> <span class="params">( <span class="keyword">boolean</span> condition, String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( condition ) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> CaptchaException( message );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 如果条件为&lt;code&gt;true&lt;/code&gt; throw &#123;<span class="doctag">@link</span> ForbiddenException&#125;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> condition : 断言条件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message   : 错误信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ForbiddenException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">assertPermissionIsTrue</span> <span class="params">( <span class="keyword">boolean</span> condition, String message )</span> <span class="keyword">throws</span> ForbiddenException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( condition ) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ForbiddenException( message );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * service 层断言</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> condition : 断言条件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message   : 错误信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServiceException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">isTrue</span> <span class="params">( <span class="keyword">boolean</span> condition, String message )</span> </span>&#123;</span><br><span class="line">        assertServiceException( condition, message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * dao 层断言</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> condition : 断言条件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message   : 错误信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> DaoException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">assertDaoIsTrue</span> <span class="params">( <span class="keyword">boolean</span> condition, String message )</span> </span>&#123;</span><br><span class="line">        daoServiceException( condition, message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 断言</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> condition : 断言条件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message   : 错误信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> DaoException 如果条件为&lt;code&gt;true&lt;/code&gt;,则会抛Service异常(异常为运行时异常,在Spring中会有统一异常处理)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">assertServiceException</span> <span class="params">( <span class="keyword">boolean</span> condition, String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( condition ) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ServiceException( message );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 断言</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> condition : 断言条件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message   : 错误信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> DaoException 如果条件为&lt;code&gt;true&lt;/code&gt;,则会抛Dao异常(异常为运行时异常,在Spring中会有统一异常处理)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">daoServiceException</span> <span class="params">( <span class="keyword">boolean</span> condition, String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( condition ) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> DaoException( message );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="json-字段动态过滤"><a href="#json-字段动态过滤" class="headerlink" title="json 字段动态过滤"></a>json 字段动态过滤</h2><p><a href="https://github.com/bohnman/squiggly-filter-jackson" target="_blank" rel="noopener">https://github.com/bohnman/squiggly-filter-jackson</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * json工具类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> : 披荆斩棘</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> : 2016/10/2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">JsonUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;jackson&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;a href="https://github.com/FasterXML/jackson-docs"&gt;document&lt;/a&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ObjectMapper BASIC         = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ObjectMapper CUSTOMIZATION = <span class="keyword">new</span> CustomizationObjectMapper();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;gson&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;a href="https://github.com/google/gson/blob/master/UserGuide.md"&gt;document&lt;/a&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Gson         GSON          = <span class="keyword">new</span> GsonBuilder().setDateFormat( DateUtils.DATE_BASIC_STYLE )</span><br><span class="line">                                                                       .create();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;fastjson&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;a href="https://github.com/alibaba/fastjson/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"&gt;document&lt;/a&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> JSON JSON;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        BASIC.setDateFormat( <span class="keyword">new</span> SimpleDateFormat( DateUtils.DATE_BASIC_STYLE ) );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 转换为Json,可过滤属性</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;默认使用Jackson进行转换,&#123;<span class="doctag">@link</span> #CUSTOMIZATION&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * 注意 : &lt;b style="color:red"&gt;&lt;code&gt;null&lt;/code&gt;将不会被序列化&lt;/b&gt;</span></span><br><span class="line"><span class="comment">     * &lt;pre&gt;</span></span><br><span class="line"><span class="comment">     *      &lt;code&gt;<span class="doctag">@Data</span>&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     *      &lt;code&gt;<span class="doctag">@Accessors</span>(chain = true)&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     *      public class User implements Serializable &#123;</span></span><br><span class="line"><span class="comment">     *          private Long           id;</span></span><br><span class="line"><span class="comment">     *          private String         name;</span></span><br><span class="line"><span class="comment">     *          private String[]       names;</span></span><br><span class="line"><span class="comment">     *          private String         username;</span></span><br><span class="line"><span class="comment">     *          private List&lt; String &gt; info;</span></span><br><span class="line"><span class="comment">     *          private Date           time;</span></span><br><span class="line"><span class="comment">     *          private Address        address;</span></span><br><span class="line"><span class="comment">     *          private Order          order;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *          public User () &#123;</span></span><br><span class="line"><span class="comment">     *              this.id = 1001L;</span></span><br><span class="line"><span class="comment">     *              this.name = null;</span></span><br><span class="line"><span class="comment">     *              this.names = new String[]&#123; "令狐冲" , "张三" , "大毛" &#125;;</span></span><br><span class="line"><span class="comment">     *              this.info = Arrays.asList( "北京", "朝阳", "密云" );</span></span><br><span class="line"><span class="comment">     *              this.time = new Date();</span></span><br><span class="line"><span class="comment">     *              this.username = "admin";</span></span><br><span class="line"><span class="comment">     *              this.address = new Address().setZip( "518000" ).setProvince( "北京" ).setName( "地址" );</span></span><br><span class="line"><span class="comment">     *              this.order = new Order().setId( 8888L ).setName( "支付宝" );</span></span><br><span class="line"><span class="comment">     *          &#125;</span></span><br><span class="line"><span class="comment">     *          &lt;code&gt;<span class="doctag">@Data</span>&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     *          &lt;code&gt;<span class="doctag">@Accessors</span>(chain = true)&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     *          public class Order implements Serializable &#123;</span></span><br><span class="line"><span class="comment">     *              private Long id;</span></span><br><span class="line"><span class="comment">     *              private String name;</span></span><br><span class="line"><span class="comment">     *          &#125;</span></span><br><span class="line"><span class="comment">     *          &lt;code&gt;<span class="doctag">@Data</span>&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     *          &lt;code&gt;<span class="doctag">@Accessors</span>(chain = true)&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     *          public class Address implements Serializable &#123;</span></span><br><span class="line"><span class="comment">     *              private String name;</span></span><br><span class="line"><span class="comment">     *              private String province;</span></span><br><span class="line"><span class="comment">     *              private String zip;</span></span><br><span class="line"><span class="comment">     *          &#125;</span></span><br><span class="line"><span class="comment">     *      &#125;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      &#123;<span class="doctag">@link</span> JsonUtils#toFilterJson(Object , String)&#125;</span></span><br><span class="line"><span class="comment">     *      String filter = "表达式";</span></span><br><span class="line"><span class="comment">     *      JsonUtils.toFilterJson(user,filter);</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      Object     String                        Presentation              Examples</span></span><br><span class="line"><span class="comment">     *      ------     ------                        ------------              -------</span></span><br><span class="line"><span class="comment">     *      user       ""                            空字符串                   &#123;&#125;</span></span><br><span class="line"><span class="comment">     *      user       null                          null                      &#123;"id":1001,"names":["令狐冲","张三","大毛"],"username":"admin","info":["北京","朝阳","密云"],"time":"2017-06-23 17:37:06","address":&#123;"name":"地址","province":"北京","zip":"518000"&#125;,"order":&#123;"id":8888,"name":"支付宝"&#125;&#125;</span></span><br><span class="line"><span class="comment">     *      user       *                             '*'通配符                  &#123;"id":1001,"names":["令狐冲","张三","大毛"],"username":"admin","info":["北京","朝阳","密云"],"time":"2017-06-23 17:37:06","address":&#123;"name":"地址","province":"北京","zip":"518000"&#125;,"order":&#123;"id":8888,"name":"支付宝"&#125;&#125;</span></span><br><span class="line"><span class="comment">     *      user       username,address              只显示某些字段               &#123;"username":"admin","address":&#123;"name":"地址","province":"北京","zip":"518000"&#125;&#125;</span></span><br><span class="line"><span class="comment">     *      user       na*,result                    '*'通配符                  &#123;"names":["令狐冲","张三","大毛"]&#125;</span></span><br><span class="line"><span class="comment">     *      user       **                            '*'通配符                  &#123;"id":1001,"names":["令狐冲","张三","大毛"],"username":"admin","info":["北京","朝阳","密云"],"time":"2017-06-23 17:37:06","address":&#123;"name":"地址","province":"北京","zip":"518000"&#125;,"order":&#123;"id":8888,"name":"支付宝"&#125;&#125;</span></span><br><span class="line"><span class="comment">     *      user       address[province,zip]         对象字段内部过滤             &#123;"address":&#123;"province":"北京","zip":"518000"&#125;&#125;</span></span><br><span class="line"><span class="comment">     *      user       (address,order)[name]         同时指定多个对象字段内部过滤   &#123;"address":&#123;"province":"北京","zip":"518000"&#125;&#125;</span></span><br><span class="line"><span class="comment">     *      user       address.zip,address.name      '.' 的方式                 &#123;"address":&#123;"name":"地址","zip":"518000"&#125;&#125;</span></span><br><span class="line"><span class="comment">     *      user       address.zip,address[name]     '.' 的方式                 &#123;"address":&#123;"name":"地址","zip":"518000"&#125;&#125;</span></span><br><span class="line"><span class="comment">     *      user       ~na[a-z]es~                   正则表达式                  &#123;"names":["令狐冲","张三","大毛"]&#125;</span></span><br><span class="line"><span class="comment">     *      user       -names,-username              '-' 排除字段                &#123;"id":1001,"info":["北京","朝阳","密云"],"time":"2017-06-23 18:27:58","address":&#123;"name":"地址","province":"北京","zip":"518000"&#125;,"order":&#123;"id":8888,"name":"支付宝"&#125;&#125;</span></span><br><span class="line"><span class="comment">     *      user       -names,username               '-' 排除字段(注意)           &#123;"username":"admin"&#125;</span></span><br><span class="line"><span class="comment">     *      user       -names,-username,*            '-' 排除字段                &#123;"id":1001,"info":["北京","朝阳","密云"],"time":"2017-06-23 18:27:58","address":&#123;"name":"地址","province":"北京","zip":"518000"&#125;,"order":&#123;"id":8888,"name":"支付宝"&#125;&#125;</span></span><br><span class="line"><span class="comment">     *      user       -user.names,-order.id         '-' 排除字段                &#123;"user":&#123;"id":1001,"username":"admin","info":["北京","朝阳","密云"],"time":"2017-07-05 13:58:20","address":&#123;"name":"地址","province":"北京","zip":"518000"&#125;,"order":&#123;"id":8888,"name":"支付宝"&#125;&#125;&#125;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;/pre&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> input  :</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filter : 过滤字段</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果转换失败返回 &lt;code&gt;null&lt;/code&gt; ,否则返回转换后的json</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> &lt;a href="https://github.com/bohnman/squiggly-filter-jackson"&gt;更多内容请看:Squiggly-document&lt;/a&gt; &lt;br/&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">toFilterJson</span> <span class="params">( Object input, String filter )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> toJson( Squiggly.init( <span class="keyword">new</span> CustomizationObjectMapper(), filter ), input );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 转换为Json</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;默认使用Jackson进行转换,&#123;<span class="doctag">@link</span> #BASIC&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> input</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果转换失败返回 &lt;code&gt;null&lt;/code&gt; ,否则返回转换后的json</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">toJson</span> <span class="params">( Object input )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> toJson( BASIC, input );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 转换为Json</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;默认使用Jackson进行转换,&#123;<span class="doctag">@link</span> #BASIC&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> input</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果转换失败返回 &lt;code&gt;null&lt;/code&gt; ,否则返回转换后的json</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">toCustomizationJson</span> <span class="params">( Object input )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> toJson( CUSTOMIZATION, input );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * json转换为指定类型</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;默认使用Jackson进行转换,&#123;<span class="doctag">@link</span> #BASIC&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * 注意 : 指定类型是内部类会报错 jackson can only instantiate non-static inner class by using default, no-arg</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputJson  : json</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> targetType : 目标类型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果解析失败返回 &lt;code&gt;null&lt;/code&gt; ,否则返回解析后的json</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt; T &gt; <span class="function">T <span class="title">jsonToType</span> <span class="params">( String inputJson, Class&lt; T &gt; targetType )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jsonToType( BASIC, inputJson, targetType );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * json转换为指定类型</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;默认使用Jackson进行转换,&#123;<span class="doctag">@link</span> #BASIC&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * 注意 : 指定类型是内部类会报错 jackson can only instantiate non-static inner class by using default, no-arg</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputJson  : json</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> targetType : 目标类型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果解析失败返回 &lt;code&gt;null&lt;/code&gt; ,否则返回解析后的json</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt; T &gt; List&lt; T &gt; jsonToListType ( String inputJson, Class&lt; T &gt; targetType ) &#123;</span><br><span class="line">        <span class="keyword">return</span> jsonToListType( BASIC, inputJson, targetType );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * json转换为指定类型(支持泛型)</span></span><br><span class="line"><span class="comment">     * &lt;pre class="code"&gt;</span></span><br><span class="line"><span class="comment">     * 示例 :</span></span><br><span class="line"><span class="comment">     * ResponseEntity&lt; User &gt; responseEntity = JsonUtils.jsonToType( jscksonJsonValue,new TypeReference&lt; ResponseEntity&lt; User &gt; &gt;() &#123;&#125; );</span></span><br><span class="line"><span class="comment">     * &lt;/pre&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputJson  : json</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> targetType : 目标类型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt; T &gt; <span class="function">T <span class="title">jsonToType</span> <span class="params">( String inputJson, TypeReference targetType )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jsonToType( BASIC, inputJson, targetType );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ObjectMapper <span class="title">getCustomizationMapper</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> CUSTOMIZATION;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ObjectMapper <span class="title">getBasicMapper</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BASIC;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Gson <span class="title">getGson</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> GSON;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> JSON <span class="title">getFastjson</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> JSON;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> &lt; T &gt; <span class="function">T <span class="title">jsonToType</span> <span class="params">( ObjectMapper objectMapper, String inputJson, TypeReference targetType )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> objectMapper.readValue( inputJson, targetType );</span><br><span class="line">        &#125; <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">            LogUtils.getLogger().catching( e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> &lt; T &gt; <span class="function">T <span class="title">jsonToType</span> <span class="params">( ObjectMapper objectMapper, String inputJson, Class&lt; T &gt; targetType )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> objectMapper.readValue( inputJson, targetType );</span><br><span class="line">        &#125; <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">            LogUtils.getLogger().catching( e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> &lt; T &gt; List&lt; T &gt; jsonToListType ( ObjectMapper objectMapper,</span><br><span class="line">                                                    String inputJson,</span><br><span class="line">                                                    Class&lt; T &gt; targetType ) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> objectMapper.readValue(</span><br><span class="line">                    inputJson,</span><br><span class="line">                    objectMapper.getTypeFactory().constructCollectionType( List.class, targetType )</span><br><span class="line">            );</span><br><span class="line">        &#125; <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">            LogUtils.getLogger().catching( e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">toJson</span> <span class="params">( ObjectMapper objectMapper, Object input )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> objectMapper.writeValueAsString( input );</span><br><span class="line">        &#125; <span class="keyword">catch</span> ( JsonProcessingException e ) &#123;</span><br><span class="line">            LogUtils.getLogger().catching( e );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomizationObjectMapper</span> <span class="keyword">extends</span> <span class="title">ObjectMapper</span> </span>&#123;</span><br><span class="line">        CustomizationObjectMapper () &#123;</span><br><span class="line">            <span class="keyword">super</span>();</span><br><span class="line">            setDateFormat( <span class="keyword">new</span> SimpleDateFormat( DateUtils.DATE_BASIC_STYLE ) );</span><br><span class="line">            setSerializationInclusion( JsonInclude.Include.NON_NULL ); <span class="comment">// &lt;code&gt;null&lt;code&gt; 不序列化</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> : 披荆斩棘</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> : 16/6/16</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@Accessors</span>( chain = <span class="keyword">true</span> )</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseEntity</span> &lt; <span class="title">T</span> &gt; </span>&#123;</span><br><span class="line">    <span class="comment">/** 通配符 **/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String        WILDCARD_ALL         = <span class="string">"*"</span>;</span><br><span class="line">    <span class="comment">/** 响应状态码 **/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span>    String        statusCode           = StatusCode.BAD_REQUEST.getStatusCode();</span><br><span class="line">    <span class="comment">/** 响应状态码对应的提示信息 **/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span>    String        statusMessage        = StatusCode.BAD_REQUEST.getStatusMessage();</span><br><span class="line">    <span class="comment">/** 响应内容 **/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span>    T             responseContent      = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 可选择的过滤字段</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;&lt;b&gt;为什么要有这个字段?&lt;/b&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;ul&gt;</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;1. 首先这个字段默认是 &lt;code&gt;null&lt;/code&gt; ,json已设置 &lt;code&gt;null&lt;/code&gt; 值不会被序列化,所以不用这个字段的时候它是不可见的&lt;/li&gt;</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;</span></span><br><span class="line"><span class="comment">     * 2. 是为了在添加权限时,可以给前端用,这个API到底是有哪些字段一目了然,如果单独再提供接口,这样每个API都要提供一个,会非常不优雅</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 这里提供了2个方法,一个是方式生成(这个最简洁),还有一个是给非pojo类型用的</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> #setOptionalFilterFields(Set)&#125;</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> #reflectionToOptionalFilterFields(Class)&#125;</span></span><br><span class="line"><span class="comment">     * &lt;/li&gt;</span></span><br><span class="line"><span class="comment">     * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment">     * 当然一般情况下这个字段也用不到</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span>    Set&lt; String &gt; optionalFilterFields = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * json处理时需要过滤的字段,默认不过滤</span></span><br><span class="line"><span class="comment">     * 具体看 &#123;<span class="doctag">@link</span> JsonUtils#toFilterJson&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span>    String        filterFields         = WILDCARD_ALL;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ResponseEntity</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ResponseEntity</span> <span class="params">( <span class="keyword">final</span> String statusCode )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>( statusCode, <span class="keyword">null</span>, <span class="keyword">null</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ResponseEntity</span> <span class="params">( <span class="keyword">final</span> String statusCode, <span class="keyword">final</span> String statusMessage )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>( statusCode, statusMessage, <span class="keyword">null</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ResponseEntity</span> <span class="params">( <span class="keyword">final</span> String statusCode, <span class="keyword">final</span> String statusMessage, <span class="keyword">final</span> T responseContent )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.statusCode = statusCode;</span><br><span class="line">        <span class="keyword">this</span>.statusMessage = statusMessage;</span><br><span class="line">        <span class="keyword">this</span>.responseContent = responseContent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">empty</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 成功请求,成功状态码自行指定</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ok</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">ok</span> <span class="params">( <span class="keyword">final</span> StatusCode ok, <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity( ok.getStatusCode(), message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 失败请求,失败状态码自行指定</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fail</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">badRequest</span> <span class="params">( <span class="keyword">final</span> StatusCode fail, <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity( fail.getStatusCode(), message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">ok</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ok( StatusCode.OK.getStatusCode(), StatusCode.OK.getStatusMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">ok</span> <span class="params">( <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ok( StatusCode.OK.getStatusCode(), message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">ok</span> <span class="params">( <span class="keyword">final</span> String ok, <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity( ok, message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">internalServerError</span> <span class="params">( <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity( StatusCode.INTERNAL_SERVER_ERROR.getStatusCode(), message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">internalServerError</span> <span class="params">( <span class="keyword">final</span> StatusCode error, <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity( error.getStatusCode(), message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">badRequest</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> badRequest( StatusCode.BAD_REQUEST.getStatusCode(), StatusCode.BAD_REQUEST.getStatusMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">badRequest</span> <span class="params">( <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> badRequest( StatusCode.BAD_REQUEST.getStatusCode(), message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">badRequest</span> <span class="params">( <span class="keyword">final</span> String fail, <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity( fail, message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">forbidden</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> forbidden( StatusCode.FORBIDDEN.getStatusMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">forbidden</span> <span class="params">( <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity( StatusCode.FORBIDDEN.getStatusCode(), message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">unauthorized</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> unauthorized( StatusCode.UNAUTHORIZED.getStatusMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">unauthorized</span> <span class="params">( <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity( StatusCode.UNAUTHORIZED.getStatusCode(), message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">serviceUnavailable</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> serviceUnavailable( StatusCode.SERVICE_UNAVAILABLE.getStatusMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity <span class="title">serviceUnavailable</span> <span class="params">( <span class="keyword">final</span> String message )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity( StatusCode.SERVICE_UNAVAILABLE.getStatusCode(), message );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 给 responseContent 添加内容</span></span><br><span class="line"><span class="comment">     * &lt;pre&gt;</span></span><br><span class="line"><span class="comment">     *     ResponseEntity.ok( "success" )</span></span><br><span class="line"><span class="comment">     *                   .add( "username", "披荆斩棘" )</span></span><br><span class="line"><span class="comment">     *                   .add( "password", "123456" )</span></span><br><span class="line"><span class="comment">     *                   .add( "ip", "localhost" );</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *     ResponseEntity&#123;statusCode='200', statusMessage='success', filterFields='*', responseContent=&#123;password=123456, ip=localhost, username=披荆斩棘&#125;&#125;</span></span><br><span class="line"><span class="comment">     * &lt;/pre&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   : &lt;code&gt;String&lt;/code&gt;类型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value : &lt;code&gt;Object&lt;/code&gt;类型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &lt;code&gt;this&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">add</span> <span class="params">( <span class="keyword">final</span> String key, <span class="keyword">final</span> Object value )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="keyword">null</span> == <span class="keyword">this</span>.responseContent ) &#123;</span><br><span class="line">            <span class="keyword">this</span>.responseContent = ( T ) <span class="keyword">new</span> HashMap&lt; String, Object &gt;();</span><br><span class="line">            Map&lt; String, Object &gt; content = ( Map&lt; String, Object &gt; ) <span class="keyword">this</span>.responseContent;</span><br><span class="line">            content.put( key, value );</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( ! ( <span class="keyword">this</span>.responseContent <span class="keyword">instanceof</span> Map ) ) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ( ( Map ) <span class="keyword">this</span>.responseContent ).put( key, value );</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 反射获取对象字段并设置到当前对象的 &#123;<span class="doctag">@link</span> #optionalFilterFields&#125; 中,忽略 serialVersionUID</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz &#123;<span class="doctag">@link</span> Class&#125;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> this</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">reflectionToOptionalFilterFields</span> <span class="params">( <span class="keyword">final</span> Class clazz )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> Field[] declaredFields = clazz.getDeclaredFields();</span><br><span class="line">        <span class="keyword">this</span>.optionalFilterFields = <span class="keyword">new</span> LinkedHashSet&lt;&gt;( declaredFields.length );</span><br><span class="line">        <span class="keyword">for</span> ( Field declaredField : declaredFields ) &#123;</span><br><span class="line">            <span class="keyword">if</span> ( <span class="string">"serialVersionUID"</span>.equalsIgnoreCase( declaredField.getName() ) ) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            optionalFilterFields.add( declaredField.getName() );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置过滤字段</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;b style="color:red"&gt;注意只会过滤 responseContent 中的内容&lt;/b&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filterFields : 过滤字段,&#123;<span class="doctag">@link</span> JsonUtils#toFilterJson(Object , String)&#125;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> this</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">setFilterFields</span> <span class="params">( <span class="keyword">final</span> String filterFields )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="keyword">null</span> == filterFields || WILDCARD_ALL.equals( filterFields ) ) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        StringBuilder buffer = <span class="keyword">new</span> StringBuilder( WILDCARD_ALL ).append( <span class="string">",responseContent["</span> );</span><br><span class="line">        <span class="comment">// 如果是分页对象,则只对分页对象内的结果集进行处理</span></span><br><span class="line">        <span class="keyword">if</span> ( <span class="keyword">this</span>.getResponseContent() <span class="keyword">instanceof</span> PageInfo ) &#123;</span><br><span class="line">            buffer.append( <span class="string">"*,list["</span> )</span><br><span class="line">                  .append( filterFields )</span><br><span class="line">                  .append( <span class="string">"]]"</span> );</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            buffer.append( filterFields )</span><br><span class="line">                  .append( <span class="string">"]"</span> );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.filterFields = buffer.toString();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置过滤字段并过滤刷新</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;b style="color:red"&gt;</span></span><br><span class="line"><span class="comment">     * 注意该方法在controller中最后 &lt;code&gt;return&lt;/code&gt; 时使用,可能会导致flush2次,因为在自定义 &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> org.springframework.web.servlet.mvc.method.annotation.ResponseBodyAdvice&#125; 的实现类中,会再次flush(因为我在返回的时候会进行flush); &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 如果,你未定义 &#123;<span class="doctag">@link</span> org.springframework.web.servlet.mvc.method.annotation.ResponseBodyAdvice&#125;</span></span><br><span class="line"><span class="comment">     * 实现类那么就需要在 &lt;code&gt;return&lt;/code&gt; 时调用 &#123;<span class="doctag">@link</span> #setFilterFieldsAndFlush(String)&#125; 而不是 &#123;<span class="doctag">@link</span> #setFilterFields(String)&#125; &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 亦或者你自定义了实现类,但是没有进行flush,那么你还是得调用 &#123;<span class="doctag">@link</span> #setFilterFieldsAndFlush(String)&#125;</span></span><br><span class="line"><span class="comment">     * &lt;/b&gt; &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 当然我可以设置&lt;code&gt;boolean&lt;/code&gt;状态值,但是我又不想这个状态值返回到外面,那么这样就需要对这个字段进行忽略,这样就不会进行序列化.&lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 但是有的时候在传输的时候是需要序列号和反序列化的,所以这里是使用约定而不是既定</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 更多 &#123;<span class="doctag">@link</span> #setFilterFields(String)&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">setFilterFieldsAndFlush</span> <span class="params">( <span class="keyword">final</span> String filterFields )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.setFilterFields( filterFields ).filterFieldsFlush();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过滤字段刷新</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 刷新后的 &lt;code&gt;this&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">filterFieldsFlush</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> JsonUtils.jsonToType( <span class="keyword">this</span>.toJson(), <span class="keyword">this</span>.getClass() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对&lt;code&gt;this&lt;/code&gt;进行json序列号,如果设置了过滤字段则会进行过滤</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> json</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toJson</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="keyword">this</span>.isNotFieldsFilter() ) &#123;</span><br><span class="line">            <span class="keyword">return</span> JsonUtils.toJson( <span class="keyword">this</span> );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> JsonUtils.toFilterJson( <span class="keyword">this</span>, <span class="keyword">this</span>.getFilterFields() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否成功</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果状态 &lt;b style="color:red"&gt;是&lt;code&gt;StatusCode.OK&lt;/code&gt;&lt;/b&gt; 则返回 &lt;code&gt;true&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isOk</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> StatusCode.OK.getStatusCode().equals( <span class="keyword">this</span>.getStatusCode() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否不成功</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> "!" &#123;<span class="doctag">@link</span> #isOk()&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isNotOk</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ! isOk();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否需要过滤字段</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> "!" &#123;<span class="doctag">@link</span> #isNotFieldsFilter()&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isFieldsFilter</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ! <span class="keyword">this</span>.isNotFieldsFilter();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否不需要过滤字段</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果 &lt;b style="color:red"&gt; null == this.getFilterFields() || &#123;<span class="doctag">@link</span> #filterFields&#125; &lt;code&gt;equals&lt;/code&gt; &#123;<span class="doctag">@link</span> #WILDCARD_ALL&#125; &lt;/b&gt;则返回 &lt;code&gt;true&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isNotFieldsFilter</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span> == <span class="keyword">this</span>.getFilterFields() || WILDCARD_ALL.equals( <span class="keyword">this</span>.getFilterFields() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> StatusCode &#123;</span><br><span class="line">        <span class="comment">/** [GET]：服务器成功返回用户请求的数据，该操作是幂等的（Idempotent）。 **/</span></span><br><span class="line">        OK( <span class="string">"200"</span>, <span class="string">"请求成功"</span> ),</span><br><span class="line">        <span class="comment">/** [POST/PUT/PATCH]：用户新建或修改数据成功。 **/</span></span><br><span class="line">        CREATED( <span class="string">"201"</span>, <span class="string">"操作成功"</span> ),</span><br><span class="line">        <span class="comment">/** 202 Accepted - [*]：表示一个请求已经进入后台排队（异步任务） **/</span></span><br><span class="line">        OK_NOT_HANDLER( <span class="string">"202"</span>, <span class="string">"收到请求"</span> ),</span><br><span class="line">        <span class="comment">/** 204 NO CONTENT - [DELETE]：用户删除数据成功。 **/</span></span><br><span class="line">        NO_CONTENT( <span class="string">"204"</span>, <span class="string">"数据删除成功"</span> ),</span><br><span class="line">        <span class="comment">/** 400 INVALID REQUEST - [POST/PUT/PATCH]：用户发出的请求有错误，服务器没有进行新建或修改数据的操作，该操作是幂等的。 **/</span></span><br><span class="line">        BAD_REQUEST( <span class="string">"400"</span>, <span class="string">"请求失败"</span> ),</span><br><span class="line">        <span class="comment">/** 401 Unauthorized - [*]：表示用户没有权限（令牌、用户名、密码错误）。 **/</span></span><br><span class="line">        UNAUTHORIZED( <span class="string">"401"</span>, <span class="string">"身份验证失败"</span> ),</span><br><span class="line">        <span class="comment">/** 403 Forbidden - [*] 表示用户得到授权（与401错误相对），但是访问是被禁止的。 **/</span></span><br><span class="line">        FORBIDDEN( <span class="string">"403"</span>, <span class="string">"权限不足"</span> ),</span><br><span class="line">        <span class="comment">/** 404 NOT FOUND - [*]：用户发出的请求针对的是不存在的记录，服务器没有进行操作，该操作是幂等的。 **/</span></span><br><span class="line">        NOT_FOUND( <span class="string">"404"</span>, <span class="string">"记录不存在"</span> ),</span><br><span class="line">        <span class="comment">/** 406 Not Acceptable - [GET]：用户请求的格式不可得（比如用户请求JSON格式，但是只有XML格式）。 **/</span></span><br><span class="line">        NOT_ACCEPTABLE( <span class="string">"404"</span>, <span class="string">"请求格式错误"</span> ),</span><br><span class="line">        REQUEST_TIME_OUT( <span class="string">"408"</span>, <span class="string">"服务器等待客户端发送的请求时间过长,超时"</span> ),</span><br><span class="line">        <span class="comment">/** 410 Gone -[GET]：用户请求的资源被永久删除，且不会再得到的。 **/</span></span><br><span class="line">        GONE( <span class="string">"410"</span>, <span class="string">"请求的资源被永久删除"</span> ),</span><br><span class="line">        <span class="comment">/** 422 请求格式正确，但是由于含有语义错误，无法响应 **/</span></span><br><span class="line">        UNPROCESSABLE_ENTITY( <span class="string">"422"</span>, <span class="string">"验证失败"</span> ),</span><br><span class="line">        TOO_MANY_REQUESTS( <span class="string">"429"</span>, <span class="string">"太多的请求"</span> ),</span><br><span class="line">        TRADE_REPETITION( <span class="string">"460"</span>, <span class="string">"重复交易"</span> ),</span><br><span class="line">        <span class="comment">/** 500 INTERNAL SERVER INTERNAL_SERVER_ERROR - [*]：服务器发生错误，用户将无法判断发出的请求是否成功。 **/</span></span><br><span class="line">        INTERNAL_SERVER_ERROR( <span class="string">"500"</span>, <span class="string">"请求出错"</span> ),</span><br><span class="line">        SERVICE_UNAVAILABLE( <span class="string">"503"</span>, <span class="string">"由于临时的服务器维护或者过载,服务器当前无法处理请求"</span> );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> String statusCode;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> String statusMessage;</span><br><span class="line"></span><br><span class="line">        StatusCode ( String statusCode, String statusMessage ) &#123;</span><br><span class="line">            <span class="keyword">this</span>.statusCode = statusCode;</span><br><span class="line">            <span class="keyword">this</span>.statusMessage = statusMessage;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getStatusMessage</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> statusMessage;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getStatusCode</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> statusCode;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>这样我在控制器中返回数据时,我就可以动态指定字段了</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@GetMapping</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt; PageInfo&lt; User &gt; &gt; listPage ( PageRowBounds pageRowBounds, UserQuery query ) &#123;</span><br><span class="line">    <span class="keyword">return</span> ResponseEntity.ok()</span><br><span class="line">                         .setResponseContent( userService.listPage( pageRowBounds, query ) )</span><br><span class="line">                         .setFilterFieldsAndFlush( <span class="string">"-password"</span> ); <span class="comment">// 这里我就想过滤掉 password 这个字段</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果在权限系统中,粒度控制到字段的话,配合 ResponseBodyAdvice 就可以很轻松的实现了</li>
</ul>
<h2 id="我想得到当前请求的原始uri并得到path变量的相关值-以及解析过程"><a href="#我想得到当前请求的原始uri并得到path变量的相关值-以及解析过程" class="headerlink" title="我想得到当前请求的原始uri并得到path变量的相关值,以及解析过程"></a>我想得到当前请求的原始uri并得到path变量的相关值,以及解析过程</h2><p>如果没看过源码不知道Spring MVC执行流程,反正只要记住一个类就行,DispatcherServlet</p>
<ul>
<li>DispatcherServlet</li>
</ul>
<p>DispatcherServlet 执行处理入口方法应该时doService,doService没有直接处理,而是交给doDispatch处理.</p>
<p>doDispatch方法最核心的代码只有4句<br>    大体分为2部分 : 处理请求和渲染页面.</p>
<pre><code>1. 根据request找到Handler
2. 根据Handler找到对应的HandlerAdapter
3. 用HandlerAdapter处理Handler
4. 调用processDispatchResult方法处理上面处理之后的结果(包含找到View并渲染输出给用户)
</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mappedHandler = getHandler(processedRequest); <span class="comment">// 1</span></span><br><span class="line">HandlerAdapterha = getHandlerAdapter(mappedHandler.getHandler()); <span class="comment">// 2</span></span><br><span class="line">mv = ha.handle(processedRequest,response,mappedHandler.getHandler()); <span class="comment">// 3</span></span><br><span class="line">processDispatchResult(processedRequest,response,mappedHandler,mv,dispatchException) <span class="comment">// 4</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/java/spring-process-00.jpg" data-action="zoom"></p>
<p>下面来看</p>
<p><img src="/images/java/spring-process-01.png" data-action="zoom"><br><img src="/images/java/spring-process-02.png" data-action="zoom"><br><img src="/images/java/spring-process-03.png" data-action="zoom"></p>
<p>具体就不看了,直接找到 RequestMappingInfoHandlerMapping 的 handleMatch 这个方法</p>
<p><img src="/images/java/spring-process-04.png" data-action="zoom"></p>
<p>既然知道Spring是设置在 request.setAttribute 中,那么在当前请求中通过request直接获取就行了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String uriVariables = ( String ) request.getAttribute( HandlerMapping.BEST_MATCHING_PATTERN_ATTRIBUTE );</span><br><span class="line"><span class="comment">// /roles/&#123;userId&#125;/&#123;roleId&#125;</span></span><br><span class="line">System.err.println( <span class="string">"uriVariables = "</span> + uriVariables );</span><br><span class="line"><span class="keyword">final</span> Map&lt; String, String &gt; decodedUriVariables = ( Map&lt; String, String &gt; ) request.getAttribute( HandlerMapping.URI_TEMPLATE_VARIABLES_ATTRIBUTE );</span><br><span class="line"><span class="comment">// &#123;userId=1, roleId=10000&#125;</span></span><br><span class="line">System.err.println( <span class="string">"decodedUriVariables = "</span> + decodedUriVariables );</span><br></pre></td></tr></table></figure>
<p>.</p>
</div><iframe src="/donate/?AliPayQR=null&amp;WeChatQR=/images/pijingzhanji.JPG&amp;GitHub=null&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://yujunhao8831.github.io/2017/07/09/spring-小技巧/" data-id="clhg8cb7700d09sf8wfefcnc9" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACK0lEQVR42u3aQW7DMAwEQP//0+21QBF3l0oKWBqfiiaRND4QFMnrip+v0fPzt/cr/97l+sSDgYHxWEZ+lFfb3H+av4h72B+7YGBgHMBIQmEbKJPQeb9OcjYMDAyMfLM8OOb/x8DAwFgJuPm1M/8tBgYGxj1j/WK5Ejr/9S6OgYHxQEZedf//vz/S38DAwHgU410tyTxotglidCoMDIytGW35vk312oLdynkwMDB2ZeQFr6SF2RbgZntdbczGwMDYjpGMVqy0BNqRsuhlYWBgHMBIyvErLYHZmEXRTsDAwDiAkZfP2uCYrJOv/3IFDAyMrRmza23bElj5fp6GYmBgnMbIRy7yENmG5vY8GBgYuzLy8n0OXkn7hi0EDAyMrRn5cEOyQdsKzT+NXi4GBsYBjHb0oU348qJbm7BiYGCcwEiGG2bfz4trs0G06C6OgYGxBWNWrG+TxRV8FIIxMDAOYLRp4noYvQckienLchsGBsZ2jLyg35bS2qPMmqAYGBgnMNqF1kfHVkYuXp4WAwPjMEb+rCSO+eU2GtHAwMA4kpFfHWel/HeNiGFgYOzNmIXXpECWlNVmVf2rPQQGBsbDGe2cVTtOkVPbK2sbrDEwMJ7OaIPmLMlLAO03l2I/BgbGAxnt8FZ7iZ0NkOWnxcDAwGhzyTZlXH81GBgYGPlmbZkseUHRWAYGBsYBjHycom1zzopxHyy3YWBgPJDRXh3b9mQOmLUHMDAwtmZ8A3jhslDZCwZ5AAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/spring-spring-小技巧/">spring spring-小技巧</a></div><div class="post-nav"><a class="pre" href="/2017/07/09/spring-小技巧-2/">spring-小技巧-2</a><a class="next" href="/2017/07/02/spring-boot-admin/">spring-boot-admin</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: '18e1ad18c984fd09f33e',
  clientSecret: '957f160a646fce08b0c0f13eb15a1a636ae70ac3',
  repo: 'yujunhao8831.github.io',
  owner: 'yujunhao8831',
  admin: ['yujunhao8831'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://yujunhao8831.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/交易/">交易</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活/">生活</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程/">编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/金融/">金融</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/spring-spring-boot-spring-cache-redis/" style="font-size: 15px;">spring spring-boot spring-cache-redis</a> <a href="/tags/股票/" style="font-size: 15px;">股票</a> <a href="/tags/2019/" style="font-size: 15px;">2019</a> <a href="/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/规则引擎/" style="font-size: 15px;">规则引擎</a> <a href="/tags/Spring-Cloud/" style="font-size: 15px;">Spring-Cloud</a> <a href="/tags/Feign/" style="font-size: 15px;">Feign</a> <a href="/tags/Zuul/" style="font-size: 15px;">Zuul</a> <a href="/tags/Hystrix/" style="font-size: 15px;">Hystrix</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/Restful-API/" style="font-size: 15px;">Restful API</a> <a href="/tags/Swagger/" style="font-size: 15px;">Swagger</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/Ribbon/" style="font-size: 15px;">Ribbon</a> <a href="/tags/MyBatis/" style="font-size: 15px;">MyBatis</a> <a href="/tags/mql5/" style="font-size: 15px;">mql5</a> <a href="/tags/spring-spring-boot-admin/" style="font-size: 15px;">spring spring-boot-admin</a> <a href="/tags/缠中说禅/" style="font-size: 15px;">缠中说禅</a> <a href="/tags/分布式调度/" style="font-size: 15px;">分布式调度</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/Eureka/" style="font-size: 15px;">Eureka</a> <a href="/tags/脚手架/" style="font-size: 15px;">脚手架</a> <a href="/tags/vpn/" style="font-size: 15px;">vpn</a> <a href="/tags/spring-spring-小技巧/" style="font-size: 15px;">spring spring-小技巧</a> <a href="/tags/分布式session共享/" style="font-size: 15px;">分布式session共享</a> <a href="/tags/测试/" style="font-size: 15px;">测试</a> <a href="/tags/观后感/" style="font-size: 15px;">观后感</a> <a href="/tags/多线程日志用户跟踪/" style="font-size: 15px;">多线程日志用户跟踪</a> <a href="/tags/目标/" style="font-size: 15px;">目标</a> <a href="/tags/问题/" style="font-size: 15px;">问题</a> <a href="/tags/交易/" style="font-size: 15px;">交易</a> <a href="/tags/理念/" style="font-size: 15px;">理念</a> <a href="/tags/疑惑/" style="font-size: 15px;">疑惑</a> <a href="/tags/Log4j2-日志/" style="font-size: 15px;">Log4j2 日志</a> <a href="/tags/java-web/" style="font-size: 15px;">java web</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/10/09/2020-10-09-指数见解/">2020-10-09-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/05/2020-05-05-指数见解/">2020-05-05-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/06/2020-03-06-指数见解/">2020-03-06-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/29/2019-07-29-指数见解/">2019-07-29-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/13/2019-05-13-指数见解/">2019-05-13-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/28/2019-角落博文有感/">2019-角落博文有感</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/25/2019-缠中说禅-教你炒股票11-理解/">2019-缠中说禅-教你炒股票11-理解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/24/2019-03-24-指数见解/">2019-03-24-指数见解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/12/2019-缠中说禅-教你炒股票10-理解/">2019-缠中说禅-教你炒股票10-理解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/12/2019-缠中说禅-教你炒股票9-理解/">2019-缠中说禅-教你炒股票9-理解</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">披荆斩棘.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" color="204, 255, 222" opacity="0.5" zIndex="-1" count="666" src="//lib.baomitu.com/canvas-nest.js/2.0.3/canvas-nest.umd.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script><script type="text/javascript" src="js/baidutongji.js?v=0.0.0"></script></div></body></html>